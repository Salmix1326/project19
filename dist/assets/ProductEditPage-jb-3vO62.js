import{k as x,l,p as f,u as m,r as h,j as e,q as v,s as b,t as P,m as j,v as N,n as S}from"./index-E7iVbXwC.js";import{u as k,o as F,I as c}from"./yup-CAIXkBua.js";const q=t=>x().shape({productName:l().required(t("validation.productName.required")).min(2,t("validation.productName.min")).max(100,t("validation.productName.max")),count:f().typeError(t("validation.count.typeError")).required(t("validation.count.required")),imgLink:l().required(t("validation.imgLink.required")).url(t("validation.imgLink.invalid"))}),L={productName:"",count:"",imgLink:""},y=()=>{const{t}=m(),a=q(t),r=k({mode:"onBlur",defaultValues:L,resolver:F(a)}),o=h.useMemo(()=>({errors:r.formState.errors}),[r.formState.errors]);return{...r,field:o}};function p({product:t={},onSubmit:a}){const{t:r}=m(),{register:o,handleSubmit:n,formState:{errors:i,isSubmitting:s,isValid:u}}=y(),g=d=>{a({...t,name:d.productName,price:Number(d.count),image:d.imgLink})};return e.jsxs("form",{onSubmit:n(g),className:"flex flex-col gap-2 max-w-md mx-auto",children:[e.jsx(c,{label:r("productForm.name"),placeholder:r("validation.productName.required"),error:i.productName?.message,...o("productName")}),e.jsx(c,{label:r("productForm.count"),placeholder:r("validation.count.required"),error:i.count?.message,...o("count")}),e.jsx(c,{label:r("productForm.imgLink"),placeholder:r("validation.imgLink.required"),error:i.imgLink?.message,...o("imgLink")}),e.jsx("button",{type:"submit",disabled:s||!u,className:"bg-blue-600 text-white rounded px-4 py-2 mt-2",children:r("productForm.save")})]})}function E({product:t,onSuccess:a}){const[r]=v(),o=async({id:n,name:i,price:s,image:u})=>{await r({id:n,data:{name:i,price:s,image:u}}),a&&a()};return e.jsx(p,{product:t,onSubmit:o})}function w({onSuccess:t}){const[a]=b(),r=async({name:o,price:n,image:i})=>{await a({name:o,price:n,image:i}),t&&t()};return e.jsx(p,{onSubmit:r})}function I(){const{id:t}=P(),a=j(),{data:r,isLoading:o}=N(t,{skip:!t}),{t:n}=m(),i=()=>{a(S.pages.ProductsPage.navigationPath)};return o&&t?e.jsxs("div",{children:[n("sharedTranslations.loading"),"..."]}):e.jsxs("div",{children:[e.jsx("h1",{children:n(t?"productForm.editButton":"productForm.addButton")}),t?e.jsx(E,{product:r,onSuccess:i}):e.jsx(w,{onSuccess:i})]})}export{I as default};
